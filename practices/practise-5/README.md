# Занятие 5. Порождающие паттерны
Генеративные паттерны позволяют создавать объекты в зависимости от контекста.
В предыдущих занятиях мы уже использовали некоторые генеративные паттерны, например, `Factory Method` внутри 
`Absatract Factory`при создании автомобилей.
В данном занятии мы рассмотрим реализацию паттерна `Builder` на примере задачи построения отчета о работе нашей системы.
Так же добавим новый тип объектов - катамараны, для дальнейшей работы.
## Функциональные требования
1. Добавить возможность составления отчета о работе системы.
2. Добавить возможность продажи катамаранов.
3. Для катамаранов уменьшить требования силы покупателя до 2 в руках/ногах + до 200 в iq.
## Требования к реализации
1. Реализовать катамараны с помощью интерфейсов и дженериков аналогично с машинам.
2. Отчет должен составляться с помощью паттерна билдер
3. Реализовать проверку типа совместимости силы с помощью enum.
4. Добавить пробросы ошибок + логирование (минимум в 3 местах)
## Тестирование
**Что нужно проверить:**
- ✓ Создание катамаранов работает корректно
- ✓ Проверка совместимости для разных типов продукции
- ✓ Builder создает полный отчет со всеми разделами
- ✓ Ошибки обрабатываются и логируются
- ✓ Цепочечные вызовы ReportBuilder работают

---
## Задание на доработку
- Добавьте в `ReportBuilder` возможность вывода текущего содержимого склада автомобилей и катамаранов.
## Пояснения к реализации

### Часть 1: Добавление катамаранов в систему

**Что нужно сделать:**
1. Создайте новую сущность **Катамаран**, используя интерфейсы и дженерики по аналогии с автомобилями.
2. Реализуйте:
    - Интерфейс `Catamaran` (аналогично `Car`)
    - Фабрику для создания катамаранов
    - Логику продажи катамаранов через `HseCarService` (переименуйте в `HseTradingService`)

**Подсказки:**
- Используйте общий интерфейс `Production` для автомобилей и катамаранов
- Переименуйте сервис для работы с обоими типами продукции
- Проверьте, как у вас реализованы фабрики для автомобилей

---

### Часть 2: Гибкая система проверок совместимости

**Что нужно сделать:**
1. Создайте enum `ProductionTypes` с типами:
   ```
   CAR,
   CATAMARAN
   ```
2. Реализуйте метод проверки совместимости покупателя с типом продукции:
   ```java
   boolean isCompatible(Customer customer, ProductionTypes type);
   ```
    - Для автомобилей: сила в руках или ногах > 5 или IQ > 300
    - Для катамаранов: сила в руках или ногах > 2 или IQ > 200

**Подсказки:**
- Используйте switch-expression для красивого кода
- Не забудьте обработать случай с неизвестным типом продукции

---

### Часть 3: Реализация паттерна Builder для отчетов

**Что нужно сделать:**
1. Создайте класс `Report` как record:
   ```java
   public record Report(String title, String content) {
       // Переопределите toString() для красивого форматирования
   }
   ```
2. Реализуйте класс `ReportBuilder` с методами:
    - `addCustomers(List<Customer> customers)` - добавляет список покупателей
    - `addOperations(List<String> operations)` - добавляет список операций
    - `addCarStock(...)` - добавляет информацию о складе автомобилей
    - `addCatamaranStock(...)` - добавляет информацию о складе катамаранов
    - `build()` - финализирует отчет

**Подсказки:**
- Используйте `StringBuilder` для накопления содержимого
- Возвращайте `this` из методов для цепочечных вызовов
- Форматируйте дату в заголовке: "Отчет за 2024-12-25 14:30"

---

### Часть 4: Обработка ошибок и логирование

**Что нужно сделать:**
Добавьте минимум в 3 местах:
1. При проверке совместимости (неизвестный тип продукции)
2. При создании отчета (пустые данные)
3. При продаже (покупатель не прошел проверку)

**Подсказки:**
- Используйте `try-catch` с осмысленными сообщениями об ошибках
- Логируйте ключевые операции (продажа, создание отчета, ошибки)

---


### Пример использования (цель):
```
var report = new ReportBuilder()
    .addCustomers(customers)
    .addCarStock(cars)
    .addCatamaranStock(catamarans)
    .addOperations(List.of("Продажа автомобилей", "Продажа катамаранов"))
    .build();

System.out.println(report);
```

Для логирования добавляем аннотацию @Slf4j из семейства ломбок и пишем в коде 
log.<уровень логов - warn,error,debug>("log text");
<details> 
<summary>Ссылки</summary>
1. 
</details>