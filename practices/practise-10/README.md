# Практика 10: Межсервисное взаимодействие с Notification Service

## Цель семинара
Настроить взаимодействие основного сервиса продажи транспортных средств с внешним микросервисом уведомлений, развернутым в Docker-контейнере.

## Предварительные требования
- Запущенный Docker и Docker Compose сервиса уведомлений (в папке `notifications`)
- Основной сервис настроен для работы с Spring Boot

## Задание

### Часть 1: Конфигурация межсервисного взаимодействия

**Задача:** Настроить основной сервис для коммуникации с сервисом уведомлений через REST API.

**Требуется реализовать:**

1. **Конфигурационный класс RestClient**
   - Создать бин `RestClient` для HTTP-запросов
   - Настроить базовый URL через properties файл
   - Добавить стандартные заголовки для JSON-формата
   - Настроить таймауты для устойчивости к сетевым сбоям

2. **DTO классы для сериализации/десериализации**
   - `NotificationRequest` - запрос на отправку уведомления
   - `NotificationResponse` - ответ от сервиса уведомлений

**Критерии успеха:**
- Основной сервис может отправлять HTTP-запросы к notification-service
- Конфигурация вынесена в properties файл
- Обработка ошибок на уровне конфигурации

### Часть 2: Клиент для работы с сервисом уведомлений

**Задача:** Создать абстракцию для взаимодействия с API уведомлений.

**Требуется реализовать:**

1. **Интерфейс NotificationClient**
   - Метод для отправки уведомлений

2. **Реализацию NotificationClientImpl**
   - Использование настроенного `RestClient`
   - Обработка HTTP-статусов и исключений
   - Логирование запросов и ответов

**Критерии успеха:**
- Изоляция логики HTTP-запросов в отдельном компоненте
- Корректная обработка сетевых ошибок
- Информативное логирование для отладки

### Часть 3: Интеграция с бизнес-логикой

**Задача:** Встроить отправку уведомлений в процесс продажи транспортных средств.

**Требуется реализовать:**

1. **Модификацию HseCarService**
   - Инъекция `NotificationClient`
   - Отправка уведомления при успешной продаже автомобиля
   - Формирование информативного сообщения для клиента

**Критерии успеха:**
- Уведомления отправляются при каждой успешной продаже
- Сообщения содержат релевантную информацию о покупке

## Технические детали реализации

### Конфигурация RestClient
- Использование билдера для создания экземпляра RestClient 
(создайте класс RestClientConfig в котором создадите стандартный клиент для всех интеграций с уведомлениями)
- Настройка базового URL через @EnableConfigurationProperties(NotificationIntegrationProperty.class)
- Стандартные заголовки: Content-Type: application/json, Accept: application/json

### Демонстрация работы
1. Запуск сервиса уведомлений через Docker Compose
2. Запуск основного сервиса
3. Выполнение операций продажи транспортных средств
4. Проверка логов на предмет отправки уведомлений
5. Проверка бд на наличие уведомлений о том, что сообщение появилось