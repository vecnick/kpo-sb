## ERP Московского зоопарка (консольная демо-версия)

Консольное приложение, демонстрирующее доменную модель и SOLID-подход с использованием DI (dig) для учёта животных и инвентаря.

### Ключевые идеи
- **Интерфейсы**:
  - `IAlive`: `FoodKgPerDay() int`, `Name() string`, `Kindness() (int, bool)` (второе значение показывает, применима ли «доброта»; только для травоядных).
  - `Inventory`: `InventoryNumber()/SetInventoryNumber(int)`; реализуется через встраиваемую структуру `Inventoriable`, чтобы не дублировать код.
- **Животные**: базовый `Animal`; травоядные `Herbo` (c уровнем доброты 0..10), хищники `Predator`; конкретные: `Monkey`, `Rabbit`, `Tiger`, `Wolf`.
- **Вещи**: базовый `Thing`; конкретные: `Table`, `Computer`.
- **Ветклиника**: `clinic.Checker` (`VetClinic`) решает, принимать ли животное. Сервис `Zoo` обращается к клинике перед добавлением.
- **Сервис зоопарка**: добавляет животных и вещи, считает суммарный суточный рацион, формирует список животных для контактного зоопарка (травоядные с добротой > 5), а также отчёты по инвентарю. Совмещённый отчёт — конкатенация отчётов «только животные» и «только вещи».
- **DI**: подключено через `go.uber.org/dig` в `cmd/zoo/main.go`.
- **Репозитории**: `AnimalRepository` и `ThingRepository` абстрагируют хранилище; по умолчанию — in-memory. Легко заменить на БД/файл.

### Структура проекта
- `internal/domain`: интерфейсы и доменные типы.
- `internal/clinic`: проверка здоровья (ветклиника).
- `internal/cmdutil`: помощники для консольного ввода с валидацией.
- `internal/zoo`: прикладной сервис с бизнес‑логикой.
- `cmd/zoo`: консольный UI и композиционный корень DI.

### Запуск
Требования: Go 1.22+

```bash
cd /home/ebal0v/Coding/hse/zoo
go build -o bin/zoo ./cmd/zoo
./bin/zoo
```

### Использование
- Добавление животных/вещей. Животные проходят проверку ветклиники (случайное решение принятия).
- Отчёты:
  - Количество животных и суммарный рацион (кг/сутки)
  - Список для контактного зоопарка (травоядные с добротой > 5)
  - Отчёты по инвентарю: общий / только животные / только вещи
- Валидация ввода: еда ≥ 0; доброта в диапазоне [0..10].
  - Корректное завершение по EOF (Ctrl+D) в консоли.

### Заметки по архитектуре
- Модель легко расширить: добавляйте новые типы животных/вещей, реализующих `IAlive` и/или `Inventory` (через `Inventoriable`).
- Решение ветклиники по умолчанию случайное; для детерминированных тестов используйте `NewVetClinicWithSeed(seed)`.
- Хранилище абстрагировано репозиториями; на проде можно заменить in-memory на БД через DI в `buildContainer()`.

### Где применены принципы SOLID
- S (Single Responsibility):
  - `internal/domain/*` — только модель предметной области (данные и минимальное поведение).
  - `internal/zoo` — бизнес‑правила зоопарка (приёмка, отчёты, подсчёты).
  - `internal/clinic` — ответственность за проверку здоровья.
  - `internal/cmdutil` и `cmd/zoo` — ответственность за ввод/вывод.
- O (Open/Closed):
  - Расширение новыми животными/вещами без изменения существующего кода благодаря интерфейсам `IAlive`, `Inventory` и встраиваемому `Inventoriable`.
  - `zoo.Service` не меняется при добавлении новых типов — достаточно реализовать интерфейсы.
- L (Liskov Substitution):
  - Любая реализация `IAlive` (травоядное, хищник, новая сущность) корректно подставима туда, где ожидается `IAlive`.
  - Любая реализация `Inventory` (животное или вещь) подставима в инвентаризационные операции.
- I (Interface Segregation):
  - Небольшие, целевые интерфейсы: `IAlive` (еда/имя/доброта) и `Inventory` (инв. номер). Потребители зависят только от нужного.
- D (Dependency Inversion):
  - `zoo.Service` зависит от абстракций `AnimalRepository`, `ThingRepository` и `clinic.Checker`, а не от конкретных реализаций.
  - Конкретные реализации (in-memory/БД, `VetClinic`) подставляются через DI (`go.uber.org/dig`).

### Переход на репозитории БД (пример)
Предоставьте `*sql.DB` и реализации репозиториев в DI, затем соберите сервис с ними (интерфейс `zoo.Service` останется неизменным). В `cmd/zoo/main.go` показано, какие провайдеры in-memory заменить.

### Тесты и покрытие
- Запуск тестов с покрытием:
```bash
go test ./... -cover
```
Или получить суммарный отчёт по функциям и HTML‑визуализацию:
```bash
go test ./... -coverprofile=coverage.out
go tool cover -func=coverage.out
go tool cover -html=coverage.out
```
- Подробный вывод:
```bash
go test ./... -v
```
- Тесты ветклиники используют `NewVetClinicWithSeed` и табличные кейсы с информативными сообщениями об ошибках.



